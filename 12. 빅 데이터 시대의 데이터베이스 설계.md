# 12.3 웹 서비스 및 데이터 모델링

## 데이터 모델링의 중요성을 알자
데이터 모델링
- 비지니스 로직에서 필요한 '데이터 항목' 들을 뽑아내고, 데이터 항목 간 관계성을 부여하여 모순이 없도록 설계한다.
- '어떤 데이터가 필요한가'를 고민하여 테이블 설계에 반영하는 방법론

웹 어플리케이션을 만들 때, 어떤 데이터를 다루고 그것들이 어떤 관계에 있는지를 밝혀내는 것은 중요하다.

NoSQL 중에는 키/값 2가지 요소만 가지는 것이 있다. 값에 임의의 데이터 타입을 넣을 수 있고, 들어가는 데이터 항목의 형식도 변경가능하다.
value 에 때려박는다고 해서 value 안에 어떤 데이터들이 들어가는지 안중요한 게 아니다. 모델링이 필요없다고 생각할 수 있지만 꼭 필요하다. 구현하는 방법의 차이일 뿐이다


## 데이터 분류
데이터 항목에는 한번 등록되면 자주 변경되지 않는 타입, 자주 변경/추가되는 타입이 있다.
전자를 마스터 데이터, 후자를 트랜잭션 데이터 라고 한다.
마스터 데이터의 예로는 store DB 의 상품 테이블의 데이터, 트랜잭션 데이터로는 결제정보 테이블 데이터를 들 수 있다.
마스터 데이터는 주로 서비스 운영 측에의해 관리되고 트랜잭션 데이터는 유저의 행동에 의해 변화한다.

사용자 정보는 모든 게임에서 사용하는 공통적인 것 (별명 등)이 있고 각 게임 고유의 것이 있다(유저 별 소유 아이템).
별명은 User ID 가 같으면 어떤 게임에서든 똑같고, 유저 별 소유 아이템정보는 게임마다 다를 수 있다.
공통적인 것은 공통 테이블에, 게임 고유의 것은 각 게임관련 테이블에 저장해야 한다.
게임 공통정보는 마스터 데이터의 측면이 강하고 게임 고유의 상태는 트랜잭션 데이터로서의 성질을 갖는다.

## 마스터계의 테이블
전체 레코드 수가 그다지 많지 않다.

## 트랜잭션계의 테이블
이러한 테이블의 레코드 수는 인기 서비스에서는 방대하다.
예를 들어 사용자 수가 천 만명이고 한 명당 100개의 아이템을 소유하고 있다면 그 테이블은 10억 레코드나 된다.
이러한 테이블은 인덱스 설계는 물론 데이터 포맷 등도 최적화해야한다.
본질적으로 중요한 것은 '무리하지 않는 범위에서 부담 없는 사양으로 하는 것'이다.

데이터의 범위를 제한함으로써 레코드수의 상단을 조정할 수도 있다, 예를 들어 사용자당 소유 아이템 수를 20개로 제한한다던가 할 수 있다.
이러한 제한은 어플리케이션의 성격이나 특색이 될 수도 있으므로 자신이 서비스 기획자가 된 것 같은 기분으로 생각해보는 것이 좋다.

## 테이블 관련
테이블은 각각 독립적인 것이 아니라 상호관계를 가지고 있다. 
대규모 웹 서비스의 경우 테이블을 서버 간에 불할하기 쉽게 하기 위해 조인을 사용하지 않는 경향이 있지만, 조인을 사용하지 않아도 논리적으로 테이블 간에 관계를 가지고 있는 경우가 많다.

### 일대다 관계
가장 표준적 형태.

### 파생 관계
'1대 0..1' 형의 테이블 관련을 말한다.
아이템 - 소비아이템, 공격아이템, 방어아이템

### 계층 관계
미션 A를 클리어하면 미션 B가 출현, B 다음 D, ...

### 계층형 부품표 타입
피라미드형의 계층 관계의 약점을 극복하는 모델



